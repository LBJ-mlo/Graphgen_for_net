# GraphGen Enhanced

ä¸€ä¸ªå®Œæ•´çš„æ•…éšœè¯Šæ–­çŸ¥è¯†å›¾è°±ç”Ÿæˆå’Œé¢„è®­ç»ƒæ•°æ®å¤„ç†ç³»ç»Ÿï¼Œæ”¯æŒç«¯åˆ°ç«¯çš„çŸ¥è¯†æå–ã€å»é‡ã€è´¨é‡æ£€æµ‹å’Œè¿‡æ»¤æµç¨‹ã€‚

## ğŸš€ é¡¹ç›®ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **çŸ¥è¯†å›¾è°±æå–**: ä»æ•…éšœæ–‡æœ¬ä¸­è‡ªåŠ¨æå–å®ä½“å’Œå…³ç³»
- **é¢„è®­ç»ƒæ•°æ®ç”Ÿæˆ**: ç”Ÿæˆå¤šç§ç±»å‹çš„é¢„è®­ç»ƒæ•°æ®
- **æ™ºèƒ½å»é‡**: åŸºäº MinHash ç®—æ³•çš„æ•°æ®å»é‡
- **è´¨é‡æ£€æµ‹**: åŸºäºå¹»è§‰æ£€æµ‹çš„æ•°æ®è´¨é‡è¯„ä¼°
- **æ•°æ®è¿‡æ»¤**: æŒ‰ç±»åˆ«å’ŒæŒ‰æ¡çš„è´¨é‡è¿‡æ»¤

### æ”¯æŒçš„æ•°æ®ç±»å‹
- **å®ä½“æè¿°**: è®¾å¤‡ã€ä¿¡å·ã€é—®é¢˜ç­‰å®ä½“çš„å®šä¹‰
- **å…³ç³»æè¿°**: å®ä½“é—´çš„é€»è¾‘å…³ç³»
- **é—®ç­”å¯¹**: æ•…éšœè¯Šæ–­ç›¸å…³çš„é—®ç­”
- **æ¨ç†é“¾**: æ•…éšœæ¨ç†çš„é€»è¾‘é“¾æ¡
- **æ¨ç†è·¯å¾„**: å®Œæ•´çš„æ•…éšœè¯Šæ–­è·¯å¾„

### è´¨é‡è¯„ä¼°æ ‡å‡†
- **ç½®ä¿¡åº¦çº§åˆ«**: åªæœ‰è¾¾åˆ° `high_confidence` çš„æ•°æ®æ‰è¢«è®¤ä¸ºæ˜¯å¥½çš„åˆæˆæ•°æ®
- **æŒ‰ç±»åˆ«è¯„ä¼°**: å¯¹æ¯ç§æ•°æ®ç±»å‹è¿›è¡Œä¸“é—¨çš„è´¨é‡è¯„ä¼°
- **æŒ‰æ¡è¿‡æ»¤**: å¯¹æ¯ä¸ªç±»åˆ«ä¸­çš„æ¯æ¡æ•°æ®å•ç‹¬è¿›è¡Œè´¨é‡è¯„ä¼°

## ğŸ“ é¡¹ç›®ç»“æ„

```
GraphGen-Enhanced/
â”œâ”€â”€ core/                          # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ knowledge_extractor.py     # çŸ¥è¯†å›¾è°±æå–
â”‚   â””â”€â”€ pretrain_knowledge_generator.py  # é¢„è®­ç»ƒæ•°æ®ç”Ÿæˆ
â”œâ”€â”€ huanjue/                       # å¹»è§‰æ£€æµ‹æ¨¡å—
â”‚   â”œâ”€â”€ hallucination_detector.py  # è´¨é‡æ£€æµ‹å™¨
â”‚   â”œâ”€â”€ entity_extractor.py        # å®ä½“æå–
â”‚   â””â”€â”€ main.py                    # æ£€æµ‹æ¨¡å—å…¥å£
â”œâ”€â”€ utils/                         # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ minhash_deduplicator.py    # MinHashå»é‡
â”‚   â””â”€â”€ logger.py                  # æ—¥å¿—å·¥å…·
â”œâ”€â”€ models/                        # æ¨¡å‹æ¨¡å—
â”‚   â””â”€â”€ llm_client.py              # LLMå®¢æˆ·ç«¯
â”œâ”€â”€ templates/                     # æ¨¡æ¿æ–‡ä»¶
â”‚   â””â”€â”€ fault_diagnosis_templates.py  # æ•…éšœè¯Šæ–­æ¨¡æ¿
â”œâ”€â”€ data/                          # æ•°æ®ç›®å½•
â”œâ”€â”€ training_data/                 # è®­ç»ƒæ•°æ®
â”œâ”€â”€ logs/                          # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ main.py                        # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ complete_pipeline.py           # å®Œæ•´æµç¨‹
â”œâ”€â”€ batch_pipeline_enhanced.py     # æ‰¹é‡å¤„ç†
â”œâ”€â”€ run_deduplication.py           # å»é‡è„šæœ¬
â”œâ”€â”€ config.py                      # é…ç½®æ–‡ä»¶
â””â”€â”€ requirements.txt               # ä¾èµ–åŒ…
```

## ğŸ› ï¸ å®‰è£…

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- ä¾èµ–åŒ…è§ `requirements.txt`

### å®‰è£…æ­¥éª¤

1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/LBJ-mlo/Graphgen_for_net.git
cd Graphgen_for_net
```

2. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

3. é…ç½®ç¯å¢ƒ
```bash
# ç¼–è¾‘ config.py æ–‡ä»¶ï¼Œé…ç½®æ‚¨çš„ API å¯†é’¥å’Œå…¶ä»–è®¾ç½®
```

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### 1. å•æ¡ˆä¾‹å¤„ç†

è¿è¡Œå®Œæ•´æµç¨‹ï¼ˆç”Ÿæˆ -> å»é‡ -> è´¨é‡æ£€æµ‹ -> è¿‡æ»¤ï¼‰ï¼š
```bash
python complete_pipeline.py
```

### 2. æ‰¹é‡å¤„ç†

å¤„ç†å¤šä¸ªæ•…éšœæ¡ˆä¾‹ï¼š
```bash
python batch_pipeline_enhanced.py
```

### 3. å•ç‹¬æ¨¡å—

#### çŸ¥è¯†å›¾è°±æå–
```bash
python main.py
```

#### æ•°æ®å»é‡
```bash
python run_deduplication.py
```

#### è´¨é‡æ£€æµ‹
```bash
cd huanjue
python main.py
```

## ğŸ“Š è¾“å‡ºæ–‡ä»¶

### ä¿å­˜çš„æ–‡ä»¶ç±»å‹

1. **å…³é”®ç»“æœæ–‡ä»¶**: `data/{case_id}_key_results.json`
   - èåˆæ‰€æœ‰é‡è¦ä¿¡æ¯çš„å®Œæ•´ç»“æœ
   - åŒ…å«å¤„ç†æ—¶é—´ã€è´¨é‡è¯„ä¼°ã€ç»Ÿè®¡ä¿¡æ¯ç­‰

2. **é«˜è´¨é‡æ•°æ®æ–‡ä»¶**: `data/{case_id}_high_quality_data.json`
   - åªæœ‰è¾¾åˆ° `high_confidence` çº§åˆ«çš„æ•°æ®
   - åŒ…å«çŸ¥è¯†å›¾è°±å’Œé¢„è®­ç»ƒçŸ¥è¯†

3. **å»é‡æ•°æ®ç›®å½•**: `pretrain_data_deduplicated_{case_id}/`
   - æŒ‰ç±»åˆ«å»é‡åçš„é¢„è®­ç»ƒæ•°æ®æ–‡ä»¶
   - åŒ…å«å„ç§æ•°æ®ç±»å‹çš„å»é‡ç»“æœ

### æ–‡ä»¶å‘½åè§„åˆ™
- ä½¿ç”¨ `case_id` ç¡®ä¿æ–‡ä»¶åå”¯ä¸€æ€§
- é¿å…å¤šä¸ªæ¡ˆä¾‹å¤„ç†æ—¶çš„æ–‡ä»¶å†²çª

## ğŸ”§ é…ç½®è¯´æ˜

### ä¸»è¦é…ç½®é¡¹

åœ¨ `config.py` ä¸­é…ç½®ï¼š

```python
# LLM é…ç½®
LLM_CONFIG = {
    "api_key": "your_api_key",
    "model": "deepseek-chat",
    "base_url": "https://api.deepseek.com"
}

# è´¨é‡è¯„ä¼°é…ç½®
DATA_FILTER_CONFIG = {
    "quality_thresholds": {
        "min_overall_score": 0.7,
        "min_consistency_score": 0.6,
        "allow_hallucination": False
    }
}

# æ–‡ä»¶ä¿å­˜é…ç½®
FILE_SAVE_CONFIG = {
    "save_high_quality_only": True,
    "save_deduplicated_data": True,
    "save_key_results": True
}
```

## ğŸ”„ å®Œæ•´æµç¨‹

```
åŸå§‹æ•…éšœæ–‡æœ¬
    â†“
çŸ¥è¯†å›¾è°±æå– + é¢„è®­ç»ƒæ•°æ®ç”Ÿæˆ
    â†“
æŒ‰ç±»åˆ«MinHashå»é‡ (entity_descriptions, relation_descriptions, qa_pairs, reasoning_chains, reasoning_paths)
    â†“
æŒ‰ç±»åˆ«è´¨é‡æ£€æµ‹ (æ•´ä½“ + å„ç±»åˆ«)
    â†“
æŒ‰æ¡è´¨é‡è¿‡æ»¤ (åªæœ‰high_confidenceçš„æ•°æ®ä¿ç•™)
    â†“
ä¿å­˜å…³é”®ç»“æœæ–‡ä»¶ (_key_results.json, _high_quality_data.json)
```

## ğŸ“ˆ æ€§èƒ½ç‰¹ç‚¹

- **é«˜æ•ˆå»é‡**: MinHash ç®—æ³•ç¡®ä¿å¿«é€Ÿå»é‡
- **æ™ºèƒ½è¿‡æ»¤**: åŸºäºç½®ä¿¡åº¦çš„å¤šå±‚æ¬¡è´¨é‡è¿‡æ»¤
- **æ–‡ä»¶æ•´åˆ**: å‡å°‘è¾“å‡ºæ–‡ä»¶æ•°é‡ï¼Œåªä¿å­˜å…³é”®ä¿¡æ¯
- **é¿å…å†²çª**: æ¯ä¸ªæ¡ˆä¾‹æœ‰ç‹¬ç«‹çš„æ–‡ä»¶å‘½å

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ GitHub Issues è”ç³»ã€‚

---

**æ³¨æ„**: ä½¿ç”¨å‰è¯·ç¡®ä¿é…ç½®äº†æ­£ç¡®çš„ API å¯†é’¥å’Œç›¸å…³è®¾ç½®ã€‚
