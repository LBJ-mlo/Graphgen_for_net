# 知识记忆验证测试集构建方法文档

## 1. 文档概述

### 1.1 背景与目标

在GraphGen Enhanced系统中，我们通过LLM从原始故障案例中提取知识并生成预训练数据。为了验证模型是否真正"内化"了这些知识，而不仅仅是记住了生成的文本，需要构建专门的测试集来验证知识记忆效果。

**核心目标**：
- 验证模型是否理解了知识的内在逻辑
- 测试模型的知识迁移能力
- 评估模型的知识推理能力
- 检验模型的知识应用能力

### 1.2 为什么需要这样的测试集构建

传统的问答测试只能验证模型是否记住了文本内容，但无法验证模型是否真正理解了知识。我们的测试集构建方法基于以下核心假设：

1. **知识理解 vs 文本记忆**：真正的知识理解表现为能够将学到的知识应用到新场景，而不仅仅是复述原文
2. **知识迁移能力**：模型能否将学到的知识迁移到相似但不同的场景中
3. **知识推理能力**：模型能否基于学到的知识进行逻辑推理
4. **知识应用能力**：模型能否将知识转化为实际行动

## 2. 测试集构建策略

### 2.1 分层测试设计

我们的测试集采用分层设计，包含三个主要类别：

1. **知识迁移测试**（40%）：验证模型能否将学到的知识迁移到新场景
2. **知识推理测试**（35%）：验证模型能否基于学到的知识进行推理
3. **知识应用测试**（25%）：验证模型能否将知识转化为实际行动

### 2.2 各类别比例说明

- **知识迁移测试（40%）**：占比最高，因为知识迁移是验证真正理解的核心指标
- **知识推理测试（35%）**：占比次之，因为推理能力体现了知识的深度理解
- **知识应用测试（25%）**：占比最低，因为应用能力是知识理解的最终体现

## 3. 知识迁移测试（40%）

### 3.1 测试原理

知识迁移测试的核心思想是：保持知识的核心逻辑不变，改变具体的场景、实体或规模，验证模型能否将学到的知识正确迁移到新场景中。

### 3.2 测试类型

#### 3.2.1 场景变体测试（15%）

**原理**：保持故障诊断的核心逻辑，改变具体的故障场景

**示例**：
- **原始场景**：SPD单板忙音播放问题
- **变体场景1**：DTMF音发生器故障
- **变体场景2**：回铃音播放异常
- **变体场景3**：语音提示音故障

**测试问题示例**：
"某局升级后，DTMF音发生器出现故障，用户拨号时听不到按键音。根据故障诊断知识，应该从哪些方面进行排查？"

**期望的知识迁移**：
- 检查音频文件加载状态
- 验证设备配置参数
- 确认升级兼容性
- 测试音频输出功能

#### 3.2.2 实体替换测试（15%）

**原理**：保持关系结构，替换具体的实体

**示例**：
- **原始实体关系**：SPD单板 → 忙音故障
- **替换实体关系1**：音频编解码器 → 语音质量故障
- **替换实体关系2**：信号处理器 → 信号失真故障
- **替换实体关系3**：数据包处理器 → 数据包丢失故障

**测试问题示例**：
"某局升级后，音频编解码器出现语音质量问题，用户反映通话声音失真。根据故障诊断知识，应该从哪些方面进行排查？"

**期望的知识迁移**：
- 检查音频编解码器的配置状态
- 验证音频处理参数的正确性
- 确认升级后编解码算法的兼容性
- 测试音频编解码功能

#### 3.2.3 规模变化测试（10%）

**原理**：从单个设备扩展到整个系统，或从系统级问题缩小到具体模块

**示例**：
- **原始规模**：单个SPD单板故障
- **扩展规模1**：整个音频处理系统故障
- **扩展规模2**：多个局点同时出现音频故障
- **缩小规模**：从系统级故障定位到具体模块

**测试问题示例**：
"某大型局点升级后，整个音频处理系统出现故障，包括忙音、拨号音、回铃音等多个音频功能异常。根据故障诊断知识，应该从哪些方面进行排查？"

**期望的知识迁移**：
- 首先确认故障的共性特征（都是音频相关）
- 检查音频处理系统的整体状态
- 验证升级对音频架构的影响
- 按优先级逐个排查各个音频模块

## 4. 知识推理测试（35%）

### 4.1 测试原理

知识推理测试的核心思想是：基于学到的知识进行逻辑推理，验证模型能否理解知识间的因果关系和逻辑链条。

### 4.2 测试类型

#### 4.2.1 因果推理测试（20%）

**原理**：验证模型能否进行正向和反向因果推理

**正向因果推理示例**：
"某局升级后，新扩SPD单板未经过测试就投入使用，根据故障诊断知识，这会导致什么问题？"

**期望的推理**：
- 新扩单板未测试 → 可能存在兼容性问题
- 兼容性问题 → 音频文件加载异常
- 音频文件加载异常 → 忙音播放故障

**反向因果推理示例**：
"如果发现某局点的忙音播放正常，但用户反映拨号音异常，根据故障诊断知识，可能的原因是什么？"

**期望的推理**：
- 忙音正常但拨号音异常 → 可能由不同设备处理
- 需要检查拨号音相关的设备配置
- 可能存在设备间配置不一致的问题

#### 4.2.2 诊断推理测试（15%）

**原理**：基于症状推理原因，或基于原因推理症状

**症状到原因推理示例**：
"某局点升级后，不仅忙音有问题，连基本的通话功能也受到影响。根据故障诊断知识，这说明了什么？"

**期望的推理**：
- 问题可能不仅仅是音频设备的问题
- 可能是系统级配置或兼容性问题
- 需要检查核心交换功能是否正常
- 可能存在更严重的系统级故障

**原因到症状推理示例**：
"如果某局点的SPD单板配置为送异步音，但异步音文件未正确加载，根据故障诊断知识，会出现什么现象？"

**期望的推理**：
- 异步音文件未加载 → 无法播放忙音
- 用户拨号时会听到异常声音或无声
- 可能影响用户体验和系统功能

## 5. 知识应用测试（25%）

### 5.1 测试原理

知识应用测试的核心思想是：验证模型能否将学到的知识转化为实际行动，包括问题解决、决策制定等。

### 5.2 测试类型

#### 5.2.1 问题解决测试（15%）

**原理**：验证模型能否基于学到的知识解决复杂问题

**复杂问题分解示例**：
"某大型局点升级后，多个模块都出现音频相关故障，包括忙音、拨号音、回铃音等。作为故障诊断专家，请制定一个系统性的排查方案。"

**期望的解决方案**：
- 首先确认故障的共性特征（都是音频相关）
- 检查音频处理系统的整体状态
- 验证升级对音频架构的影响
- 按优先级逐个排查各个音频模块
- 建立音频故障的关联性分析

**预防措施制定示例**：
"为了避免类似忙音故障再次发生，请制定一套完整的预防措施和监控方案。"

**期望的预防措施**：
- 建立音频设备配置标准化流程
- 实施升级前的音频功能测试
- 设置音频质量监控告警
- 建立音频设备备份和切换机制
- 制定音频故障应急处理预案

#### 5.2.2 决策制定测试（10%）

**原理**：验证模型能否基于学到的知识制定决策

**资源配置决策示例**：
"某局点计划扩容音频处理能力，根据故障诊断知识，应该如何配置SPD单板？"

**期望的决策**：
- 建议配置两块SPD单板（主备用）
- 避免配置过多单板导致资源争用
- 确保每块单板都经过严格测试
- 建立单板间的负载均衡机制

**升级策略决策示例**：
"某局点计划进行系统升级，根据故障诊断知识，应该采取哪些措施确保音频功能不受影响？"

**期望的决策**：
- 升级前进行全面的音频功能测试
- 准备音频设备的回滚方案
- 升级后立即验证音频功能
- 建立音频故障的快速响应机制

## 6. 测试用例设计原则

### 6.1 设计原则

1. **知识核心不变**：保持知识的核心逻辑和因果关系不变
2. **场景适度变化**：场景变化要适度，既不能过于相似，也不能过于不同
3. **难度梯度合理**：从简单到复杂，逐步验证知识理解深度
4. **覆盖全面性**：确保测试覆盖知识的各个方面

### 6.2 质量控制

1. **避免过度相似**：测试用例不能与原始案例过于相似
2. **避免过度不同**：测试用例不能与原始案例过于不同
3. **保持逻辑一致**：确保推理逻辑与原始知识一致
4. **验证可行性**：确保解决方案在实际中可行

## 7. 评估标准

### 7.1 知识迁移评估标准

- **知识迁移准确率**：模型正确迁移知识的比例（权重：40%）
- **推理一致性**：迁移后推理逻辑的一致性（权重：30%）
- **解决方案适用性**：迁移后解决方案的适用程度（权重：30%）

### 7.2 知识推理评估标准

- **推理准确性**：推理结果的正确程度（权重：40%）
- **知识迁移度**：推理过程中知识迁移的程度（权重：35%）
- **逻辑一致性**：推理过程的逻辑一致性（权重：25%）

### 7.3 知识应用评估标准

- **解决方案完整性**：解决方案的完整程度（权重：40%）
- **知识整合度**：知识整合的程度（权重：35%）
- **实际适用性**：解决方案的实际适用程度（权重：25%）

## 8. 使用指南

### 8.1 测试集构建步骤

1. **分析原始案例**：深入理解原始案例的知识结构和逻辑关系
2. **设计测试类型**：根据验证目标选择相应的测试类型
3. **生成测试用例**：基于设计原则生成具体的测试用例
4. **验证测试质量**：确保测试用例的质量和有效性
5. **执行测试评估**：执行测试并评估结果

### 8.2 最佳实践

1. **测试用例设计**：确保测试用例的多样性和代表性
2. **评估标准设置**：根据具体应用场景设置合适的评估标准
3. **结果分析**：深入分析测试结果，找出模型的优势和不足
4. **持续优化**：根据分析结果持续优化测试集

## 9. 总结

本测试集构建方法通过分层测试设计，全面验证模型的知识记忆效果。通过知识迁移测试、知识推理测试和知识应用测试，能够有效区分模型是真正理解了知识还是仅仅记住了文本。

这种方法的优势在于：
1. **验证真正的理解**：不是测试模型能否复述，而是测试模型能否应用知识
2. **测试迁移能力**：验证模型能否将学到的知识迁移到新场景
3. **评估推理能力**：测试模型能否基于学到的知识进行推理
4. **检验应用能力**：验证模型能否将知识转化为实际行动

通过这种方法，我们能够更准确地评估模型的知识记忆效果，为模型训练和优化提供有价值的指导。
